diff -urNp redhat-rpm-config-8.0.45_orig/find-requires redhat-rpm-config-8.0.45/find-requires
--- redhat-rpm-config-8.0.45_orig/find-requires	2006-07-30 14:58:01.000000000 -0400
+++ redhat-rpm-config-8.0.45/find-requires	2007-04-03 00:00:18.000000000 -0400
@@ -5,11 +5,6 @@
 # sonames, script interpreters, and perl modules.
 #
 
-if [ "$1" ]
-then
-   package_name = "$1"
-fi
-
 ulimit -c 0
 
 #
@@ -144,21 +139,18 @@ done | sort -u
 # cheat a little here by looking first for a kernel, then for a kmod.
 #
 
-is_kmod=1
+unset is_kmod
+
 for f in $filelist; do
     if [ $(echo "$f" | sed -r -ne 's:^.*/lib/modules/(.*)/(.*).ko$:\2:p') ]
     then
-        is_kernel=1;
-    fi
-    if [ $(echo "$f" | sed -r -ne 's:^.*/boot/(.*):\1:p') ]
+        is_kmod=1;
+    elif [ $(echo "$f" | sed -r -ne 's:^.*/boot/(.*):\1:p') ]
     then
-        unset is_kmod;
+	unset is_kmod;
+	break;
     fi
 done
-if [ ! "$is_kernel" ] || [ "$package_name" == "kernel" ]
-then
-    unset is_kmod
-fi
 
 [ -x /usr/lib/rpm/redhat/find-requires.ksyms ] && [ "$is_kmod" ] &&
     printf "%s\n" "${filelist[@]}" | /usr/lib/rpm/redhat/find-requires.ksyms
diff -urNp redhat-rpm-config-8.0.45_orig/symset-table redhat-rpm-config-8.0.45/symset-table
--- redhat-rpm-config-8.0.45_orig/symset-table	2006-06-12 22:48:59.000000000 -0400
+++ redhat-rpm-config-8.0.45/symset-table	2007-04-03 00:00:18.000000000 -0400
@@ -19,6 +19,11 @@ for symsets in /boot/symsets-*.tar.gz; d
     | tar xf -
 done
 
+for symsets in /usr/src/kernels/*/symsets-*.tar.gz; do
+    zcat $symsets \
+    | tar xf -
+done
+
 for symsets in *; do
     krel=${symsets#symsets-}
     for symset in $symsets/*; do
